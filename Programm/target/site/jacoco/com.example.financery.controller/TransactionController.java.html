<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="ru"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>TransactionController.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Financery</a> &gt; <a href="index.source.html" class="el_package">com.example.financery.controller</a> &gt; <span class="el_source">TransactionController.java</span></div><h1>TransactionController.java</h1><pre class="source lang-java linenums">package com.example.financery.controller;

import com.example.financery.dto.TransactionDtoRequest;
import com.example.financery.dto.TransactionDtoResponse;
import com.example.financery.service.TransactionService;
import com.example.financery.utils.InMemoryCache;
import io.swagger.v3.oas.annotations.Operation;
import io.swagger.v3.oas.annotations.Parameter;
import io.swagger.v3.oas.annotations.tags.Tag;
import jakarta.validation.Valid;
import lombok.AllArgsConstructor;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping(&quot;/transactions&quot;)
@AllArgsConstructor
@Tag(name = &quot;Транзакции&quot;, description = &quot;Управление транзакциями&quot;)
public class TransactionController {

    private final TransactionService transactionService;

    private final InMemoryCache cache;

    @Operation(
            summary = &quot;Получение всех существующих транзакций&quot;,
            description = &quot;Возвращает список всех транзакций, доступных в системе.&quot;
    )
    @GetMapping(&quot;/get-all-transactions&quot;)
    public List&lt;TransactionDtoResponse&gt; getAllTransactions() {
<span class="nc" id="L33">        return transactionService.getAllTransactions();</span>
    }

    @Operation(
            summary = &quot;Получение транзакции по ID&quot;,
            description = &quot;Возвращает информацию о транзакции с указанным ID.&quot;
    )
    @GetMapping(&quot;/get-transaction-by-id/{transactionId}&quot;)
    public ResponseEntity&lt;TransactionDtoResponse&gt; getTransactionById(
            @Parameter(description = &quot;ID транзакции, которую необходимо получить&quot;,
                    required = true, example = &quot;1&quot;)
            @PathVariable long transactionId) {
<span class="nc" id="L45">        return ResponseEntity.ok(transactionService.getTransactionById(transactionId));</span>
    }

    @Operation(
            summary = &quot;Получение всех транзакций пользователя&quot;,
            description = &quot;Возвращает список всех транзакций,&quot;
                    + &quot; принадлежащих пользователю с указанным ID.&quot;
    )
    @GetMapping(&quot;/get-all-user-transactions/{userId}&quot;)
    public List&lt;TransactionDtoResponse&gt; getAllUserTransactions(
            @Parameter(description = &quot;ID пользователя, чьи транзакции необходимо получить&quot;,
                    required = true, example = &quot;1&quot;)
            @PathVariable long userId) {
<span class="nc" id="L58">        return transactionService.getTransactionsByUserId(userId);</span>
    }

    @Operation(
            summary = &quot;Получение всех транзакций по счету&quot;,
            description = &quot;Возвращает список всех транзакций,&quot;
                    + &quot; связанных со счетом по указанному ID счета.&quot;
    )
    @GetMapping(&quot;/get-all-bill-transactions/{billId}&quot;)
    public List&lt;TransactionDtoResponse&gt; getAllBillTransactions(
            @Parameter(description = &quot;ID счета, транзакции которого необходимо получить&quot;,
                    required = true, example = &quot;1&quot;)
            @PathVariable long billId) {
<span class="nc" id="L71">        return transactionService.getTransactionsByBillId(billId);</span>
    }

    @Operation(
            summary = &quot;Создание новой транзакции&quot;,
            description = &quot;Создает новую транзакцию на основе переданных данных.&quot;
    )
    @PostMapping(&quot;/create&quot;)
    public TransactionDtoResponse createBill(
            @Parameter(description = &quot;Данные для создания новой транзакции&quot;, required = true)
            @Valid @RequestBody TransactionDtoRequest transactionDto) {
<span class="nc" id="L82">        return transactionService.createTransaction(transactionDto);</span>
    }

    @Operation(
            summary = &quot;Обновление транзакции по ID&quot;,
            description = &quot;Обновляет данные транзакции с указанным ID на основе переданных данных.&quot;
    )
    @PutMapping(&quot;/update-by-id/{transactionId}&quot;)
    public TransactionDtoResponse updateTransactionById(
            @Parameter(description = &quot;ID транзакции, которую необходимо обновить&quot;,
                    required = true, example = &quot;1&quot;)
            @PathVariable long transactionId,
            @Parameter(description = &quot;Обновленные данные транзакции&quot;, required = true)
            @Valid @RequestBody TransactionDtoRequest transasctionDto) {
<span class="nc" id="L96">        return transactionService.updateTransaction(transactionId, transasctionDto);</span>
    }

    @Operation(
            summary = &quot;Удаление транзакции по ID&quot;,
            description = &quot;Удаляет транзакцию с указанным ID.&quot;
    )
    @DeleteMapping(&quot;/delete-by-id/{transactionId}&quot;)
    public void deleteTransactionById(
            @Parameter(description = &quot;ID транзакции, которую необходимо удалить&quot;,
                    required = true, example = &quot;1&quot;)
            @PathVariable long transactionId) {
<span class="nc" id="L108">        transactionService.deleteTransaction(transactionId);</span>
<span class="nc" id="L109">    }</span>

    @Operation(
            summary = &quot;Очистка всего кэша&quot;,
            description = &quot;Удаляет все данные из кэша транзакций.&quot;
    )
    @DeleteMapping(&quot;/cache/clear&quot;)
    public ResponseEntity&lt;String&gt; clearCache() {
<span class="nc" id="L117">        cache.clear();</span>
<span class="nc" id="L118">        return ResponseEntity.ok(&quot;Cache cleared successfully&quot;);</span>
    }

    @Operation(
            summary = &quot;Очистка кэша для пользователя&quot;,
            description = &quot;Удаляет данные кэша для пользователя с указанным ID.&quot;
    )
    @DeleteMapping(&quot;/cache/clear/{userId}&quot;)
    public ResponseEntity&lt;String&gt; clearCacheForUser(
            @Parameter(description = &quot;ID пользователя, для которого необходимо очистить кэш&quot;,
                    required = true, example = &quot;1&quot;)
            @PathVariable long userId) {
<span class="nc" id="L130">        cache.clearForUser(userId);</span>
<span class="nc" id="L131">        return ResponseEntity.ok(&quot;Cache cleared for userId: &quot; + userId);</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.13.202504020838</span></div></body></html>